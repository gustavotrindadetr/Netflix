ds_imdb <- imdb_url %>%
html_nodes("ColumnTitle a")
View(ds_imdb)
ds_imdb <- imdb_url %>%
html_nodes("ColumnTitle a") %>%
html_text()
ds_imdb <- imdb_url %>%
html_nodes("titleColumn a")
View(ds_imdb)
ds_imdb <- imdb_url %>%
html_nodes("titleColumn.a")
View(ds_imdb)
ds_imdb <- imdb_url %>%
html_nodes(".titleColumn.a")
ds_imdb <- imdb_url %>%
html_nodes(".titleColumn.a") %>%
html_text()
ds_imdb <- imdb_url %>%
html_nodes("td.titleColumn.a") %>%
html_text()
ds_imdb <- imdb_url %>%
html_nodes("td.titleColumn.a")
View(ds_imdb)
imdb_url <- html("https://www.imdb.com/chart/top?ref_=nv_wl_img_3")
imdb_url <- html("https://www.imdb.com/chart/top?ref_=nv_wl_img_3")
imdb_url <- read_html("https://www.imdb.com/chart/top?ref_=nv_wl_img_3")
imdb_url <- read_html("https://www.imdb.com/chart/top?ref_=nv_wl_img_3")
ds_imdb <- imdb_url %>%
html_nodes("td.titleColumn.a")
ds_imdb <- imdb_url %>%
html_nodes("td")
View(ds_imdb)
ds_imdb <- imdb_url %>%
html_nodes(xpath = '//*[@id="main"]/div/span/div/div/div[3]/table/tbody/tr[1]/td[2]')
View(ds_imdb)
ds_imdb <- imdb_url %>%
html_nodes(xpath = '//*[@id="main"]/div/span/div/div/div[3]/table/tbody/tr[1]/td[2]') %>%
html_table()
ds_imdb <- imdb_url %>%
html_nodes(xpath = '//*[@id="main"]/div/span/div/div/div[3]/table/tbody/tr[1]/td[2]') %>%
html_text()
View(imdb_url)
ds_imdb
ds_imdb <- imdb_url %>%
html_nodes(xpath = '//*[@id="main"]/div/span/div/div/div[3]/table/tbody') %>%
html_text()
ds_imdb
ds_imdb <- imdb_url %>%
html_nodes('//*[@id="main"]/div/span/div/div/div[3]/table/tbody') %>%
html_table()
ds_imdb <- imdb_url %>%
html_nodes('.titleColumn')
View(ds_imdb)
ds_imdb <- imdb_url %>%
html_nodes('.titleColumn.title')
View(ds_imdb)
View(ds_imdb)
ds_imdb <- imdb_url %>%
html_nodes('.titleColumn title')
ds_imdb <- imdb_url %>%
html_nodes('.titleColumn')
View(ds_imdb)
ds_imdb <- imdb_url %>%
html_nodes('.titleColumn a')
View(ds_imdb)
ds_imdb <- imdb_url %>%
html_nodes('.titleColumn a title')
ds_imdb <- imdb_url %>%
html_nodes('.titleColumn a.title')
ds_imdb <- imdb_url %>%
html_nodes('.titleColumn a')
ds_imdb <- imdb_url %>%
html_nodes('.titleColumn a') %>%
html_text
ds_imdb <- imdb_url %>%
html_nodes('.titleColumn a') %>%
html_text()
ds_imdb
rm(ds_imdb)
ds_imdb_rank <- imdb_url %>%
html_nodes('.ratingColumn.imdbRating strong') %>%
html_text()
ds_imdb_rank
rbind(ds_imdb_title, ds_imdb_rank)
ds_imdb_title <- imdb_url %>%
html_nodes('.titleColumn a') %>%
html_text()
ds_imdb_rank <- imdb_url %>%
html_nodes('.ratingColumn.imdbRating strong') %>%
html_text()
rbind(ds_imdb_title, ds_imdb_rank)
ds_imdb <- as.dafa.frame(rbind(ds_imdb_title, ds_imdb_rank))
ds_imdb <- as_data_frame(rbind(ds_imdb_title, ds_imdb_rank))
ds_imdb <- as_tibble(rbind(ds_imdb_title, ds_imdb_rank))
ds_imdb
View(ds_imdb)
ds_imdb_rank <- imdb_url %>%
html_nodes('.imdbRating strong') %>%
html_text()
ds_imdb_rank
rbind(ds_imdb_title, ds_imdb_rank)
ds_imdb <- rbind(ds_imdb_title, ds_imdb_rank))
View(ds_imdb)
ds_imdb <- cbind(ds_imdb_title, ds_imdb_rank)
View(ds_imdb)
View(ds_imdb)
ds_imdb <- as_tibble(cbind(ds_imdb_title, ds_imdb_rank))
View(ds_imdb)
write.csv2(ds_netflix[-1], "ds_netflix.csv", sep = ';')
write.csv2(ds_netflix[-1], "ds_netflix.csv", sep = ';')
write.csv2(ds_netflix, "ds_netflix.csv", sep = ';', row.names = F)
write.csv2(ds_finance, "ds_finance.csv", sep = ';', row.names = F)
write.csv2(ds_expansion, "ds_expansion.csv", sep = ';', row.names = F)
write.csv2(ds_vod, "ds_vod.csv", sep = ';', row.names = F)
View(ds_finance)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
mutate(revenue = `Revenuein mil. USD-$`)
View(ds_finance)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
rename(revenue = `Revenuein mil. USD-$`, netIncome = `Net incomein mil. USD-$`)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`)
View(ds_finance)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`) %>%
mutate(revenue = revenue * 1000000, netIncome = netIncome * 1000000)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = as.numeric(`Revenuein mil. USD-$`),
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`) %>%
mutate(revenue = revenue * 1000000, netIncome = netIncome * 1000000)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = as.numeric(`Revenuein mil. USD-$`),
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`)
ds_finance
summary(ds_finance)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`) %>%
mutate(revenue = format(as.numeric(revenue)))
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`) %>%
mutate(revenue = format(as.double(revenue)))
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`) %>%
mutate(revenue = as.double(revenue))
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`) %>%
mutate(as.double(revenue))
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`) %>%
mutate(double(type.convert(revenue)))
ds_expansion <- netflix_url %>%
html_node(xpath = '//*[@id="mw-content-text"]/div[1]/table[4]') %>%
html_table(fill = T)
ds_expansion <- netflix_url %>%
html_node(xpath = '//*[@id="mw-content-text"]/div[1]/table[4]') %>%
html_table(fill = T)
ds_finance
summary(ds_finance) <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`)
summary(ds_finance)
ds_finance
options(OutDec = '.' )
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`)
ds_finance
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`) %>%
replace(revenue,",",".")
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`) %>%
substitute(',','.')
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`)
ds_finance
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`) %>%
substitute(revenue,',','.')
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`) %>%
substitute(',','.', revenue)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`)
options(OutDec = ',' )
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`)
ds_finance
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table()
ds_finance
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`,
stonks = `Price per Sharein USD-$`)
ds_finance
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`)
ds_finance
library(dplyr)
library(tidyr)
library(rvest)
options(OutDec = ',' )
### Read CSV
df1 <- read.csv2("netflix_titles.csv", sep = ',', header = TRUE, encoding = "UTF-8")
### Fix Duration Column and Cast
ds_netflix_titles <- df1 %>%
separate(duration, into = c('duration_num', 'duration_type'), sep = " ") %>%
separate_rows(cast, sep = ', ')
### Read CSV
df1 <- read.csv2("netflix_titles.csv", sep = ',', header = TRUE, encoding = "UTF-8")
setwd("~/GitHub/Netflix")
### Read CSV
df1 <- read.csv2("netflix_titles.csv", sep = ',', header = TRUE, encoding = "UTF-8")
### Read CSV
df1 <- read.csv2("netflix_titles.csv", sep = ',', header = TRUE, encoding = "UTF-8")
### Fix Duration Column and Cast
ds_netflix_titles <- df1 %>%
separate(duration, into = c('duration_num', 'duration_type'), sep = " ") %>%
separate_rows(cast, sep = ', ')
### Export File
write.csv2(ds_netflix_titles, "ds_netflix_titles.csv", sep = ';')
## Getting Oscars' Table
oscars_url <- read_html("https://en.wikipedia.org/wiki/List_of_Academy_Award-winning_films")
netflix_url <- read_html("https://en.wikipedia.org/wiki/Netflix#Film_and_television_deals")
imdb_url <- read_html("https://www.imdb.com/chart/top?ref_=nv_wl_img_3")
ds_oscars
ds_oscars
ds_oscars <- oscars_url %>%
html_node("table") %>%
html_table() %>%
rename(title = Film)
imdb_url <- read_html("https://www.imdb.com/chart/top?ref_=nv_wl_img_3")
ds_expansion <- netflix_url %>%
html_node(xpath = '//*[@id="mw-content-text"]/div[1]/table[4]') %>%
html_table(fill = T)
ds_imdb_title <- imdb_url %>%
html_nodes('.titleColumn a') %>%
html_text()
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`)
ds_vod <- netflix_url %>%
html_node(xpath = '//*[@id="mw-content-text"]/div[1]/table[5]') %>%
html_table()
ds_imdb_rank <- imdb_url %>%
html_nodes('.imdbRating strong') %>%
html_text()
ds_imdb <- as_tibble(cbind(ds_imdb_title, ds_imdb_rank))
ds_imdb
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`)
ds_finance
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`) %>%
replace(revenue, ',', '.')
replace(revenue, c(','), c('.')
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`) %>%
replace(revenue, c(','), c('.'))
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`) %>%
replace(revenue, c(','), c('.'))
install.packages("stringr")
install.packages("stringr")
library(stringr)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`) %>%
str_replace(revenue, ',', '.')
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`) %>%
str_replace(revenue, ",", ".")
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`) %>%
str_replace_all(revenue, ",", ".")
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`) %>%
mutate(revenue = str_replace_all(revenue, ",", "."))
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`) %>%
mutate(revenue = str_replace_all(revenue, ",", "."))
library(dplyr)
library(tidyr)
library(rvest)
library(stringr)
### Fix Duration Column and Cast
ds_netflix_titles <- df1 %>%
separate(duration, into = c('duration_num', 'duration_type'), sep = " ") %>%
separate_rows(cast, sep = ', ')
## Getting Oscars' Table
oscars_url <- read_html("https://en.wikipedia.org/wiki/List_of_Academy_Award-winning_films")
netflix_url <- read_html("https://en.wikipedia.org/wiki/Netflix#Film_and_television_deals")
### Read CSV
df1 <- read.csv2("netflix_titles.csv", sep = ',', header = TRUE, encoding = "UTF-8")
imdb_url <- read_html("https://www.imdb.com/chart/top?ref_=nv_wl_img_3")
### Export File
write.csv2(ds_netflix_titles, "ds_netflix_titles.csv", sep = ';')
ds_expansion <- netflix_url %>%
html_node(xpath = '//*[@id="mw-content-text"]/div[1]/table[4]') %>%
html_table(fill = T)
ds_imdb_title <- imdb_url %>%
html_nodes('.titleColumn a') %>%
html_text()
ds_imdb <- as_tibble(cbind(ds_imdb_title, ds_imdb_rank))
write.csv2(ds_netflix, "ds_netflix.csv", sep = ';', row.names = F)
write.csv2(ds_finance, "ds_finance.csv", sep = ';', row.names = F)
write.csv2(ds_expansion, "ds_expansion.csv", sep = ';', row.names = F)
ds_oscars <- oscars_url %>%
html_node("table") %>%
html_table() %>%
rename(title = Film)
write.csv2(ds_vod, "ds_vod.csv", sep = ';', row.names = F)
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`) %>%
mutate(revenue = str_replace_all(revenue, ",", "."))
ds_vod <- netflix_url %>%
html_node(xpath = '//*[@id="mw-content-text"]/div[1]/table[5]') %>%
html_table()
ds_imdb_rank <- imdb_url %>%
html_nodes('.imdbRating strong') %>%
html_text()
## Joining Netflix Movies with Oscars]
ds_netflix <- left_join(ds_netflix_titles, ds_oscars, by = "title")
### Read CSV
df1 <- read.csv2("netflix_titles.csv", sep = ',', header = TRUE, encoding = "UTF-8")
### Fix Duration Column and Cast
ds_netflix_titles <- df1 %>%
separate(duration, into = c('duration_num', 'duration_type'), sep = " ") %>%
separate_rows(cast, sep = ', ')
### Export File
write.csv2(ds_netflix_titles, "ds_netflix_titles.csv", sep = ';')
## Getting Oscars' Table
oscars_url <- read_html("https://en.wikipedia.org/wiki/List_of_Academy_Award-winning_films")
netflix_url <- read_html("https://en.wikipedia.org/wiki/Netflix#Film_and_television_deals")
imdb_url <- read_html("https://www.imdb.com/chart/top?ref_=nv_wl_img_3")
ds_finance <- netflix_url %>%
html_node("table.wikitable.float-left") %>%
html_table() %>%
transmute(year = Year,
revenue = `Revenuein mil. USD-$`,
netIncome = `Net incomein mil. USD-$`) %>%
mutate(revenue = str_replace_all(revenue, ",", "."))
ds_oscars <- oscars_url %>%
html_node("table") %>%
html_table() %>%
rename(title = Film)
imdb_url <- read_html("https://www.imdb.com/chart/top?ref_=nv_wl_img_3")
ds_oscars <- oscars_url %>%
html_node("table") %>%
html_table() %>%
rename(title = Film)
